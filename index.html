<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA Trading Bot - Lúmenia</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { background-color: black; margin: 1; }
        /* Ajuste para ícones aparecerem */
        .lucide { display: inline-block; vertical-align: middle; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Importando os ícones da biblioteca global
        const { 
            Mail, User, TrendingUp, Upload, BarChart3, 
            Settings, Camera, CheckCircle, TrendingDown 
        } = lucide;

        const { useState, useEffect } = React;

        const LoginPage = ({ onLogin }) => {
            const [nome, setNome] = useState('');
            const [email, setEmail] = useState('');
            const [mostrandoSucesso, setMostrandoSucesso] = useState(false);

            const handleLogin = () => {
                if (nome.trim() && email.trim() && email.includes('@')) {
                    setMostrandoSucesso(true);
                } else {
                    alert('Por favor, preencha nome e email corretamente!');
                }
            };

            const acessarBot = () => {
                onLogin({ nome, email });
            };

            if (mostrandoSucesso) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-black via-amber-600 to-black flex items-center justify-center p-4">
                        <div className="bg-black/90 backdrop-blur-sm rounded-3xl p-12 max-w-md w-full border-2 border-yellow-400/50 shadow-2xl text-center">
                            <div className="mb-6">
                                <div className="w-20 h-20 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <TrendingUp className="w-10 h-10 text-black" />
                                </div>
                                <h2 className="text-3xl font-bold text-yellow-400 mb-2">Bem-vindo!</h2>
                                <p className="text-yellow-100 text-lg">{nome}</p>
                                <p className="text-yellow-300 text-sm mt-1">{email}</p>
                            </div>
                            <div className="bg-green-900/30 border-2 border-green-500 rounded-xl p-4 mb-6">
                                <p className="text-green-400 font-semibold">Login realizado com sucesso!</p>
                            </div>
                            <button onClick={acessarBot} className="w-full bg-gradient-to-r from-yellow-400 to-amber-500 hover:from-yellow-300 hover:to-amber-400 text-black font-bold text-lg py-4 rounded-xl transition-all shadow-lg transform hover:scale-105">
                                Acessar Bot de Analise
                            </button>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-black via-amber-600 to-black flex items-center justify-center p-4">
                    <div className="bg-black/90 backdrop-blur-sm rounded-3xl p-10 max-w-md w-full border-2 border-yellow-400/50 shadow-2xl">
                        <div className="text-center mb-8">
                            <div className="w-20 h-20 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg">
                                <TrendingUp className="w-10 h-10 text-black" />
                            </div>
                            <h1 className="text-3xl font-bold text-yellow-400 mb-2">IA Trading Bot</h1>
                            <p className="text-yellow-100">Analise Profissional de Scalping</p>
                        </div>
                        <div className="space-y-6">
                            <div>
                                <label className="block text-yellow-400 text-sm font-semibold mb-2">Nome Completo</label>
                                <div className="relative">
                                    <User className="absolute left-3 top-1/2 transform -translate-y-1/2 text-yellow-400 w-5 h-5" />
                                    <input type="text" value={nome} onChange={(e) => setNome(e.target.value)} placeholder="Digite seu nome" className="w-full bg-black/70 text-yellow-100 rounded-xl pl-12 pr-4 py-3 border-2 border-yellow-400/30 focus:border-yellow-400 focus:outline-none placeholder-yellow-600 transition-all" />
                                </div>
                            </div>
                            <div>
                                <label className="block text-yellow-400 text-sm font-semibold mb-2">Email (Gmail)</label>
                                <div className="relative">
                                    <Mail className="absolute left-3 top-1/2 transform -translate-y-1/2 text-yellow-400 w-5 h-5" />
                                    <input type="email" value={email} onChange={(e) => setEmail(e.target.value)} placeholder="seuemail@gmail.com" className="w-full bg-black/70 text-yellow-100 rounded-xl pl-12 pr-4 py-3 border-2 border-yellow-400/30 focus:border-yellow-400 focus:outline-none placeholder-yellow-600 transition-all" />
                                </div>
                            </div>
                            <button onClick={handleLogin} className="w-full bg-gradient-to-r from-yellow-400 to-amber-500 hover:from-yellow-300 hover:to-amber-400 text-black font-bold text-lg py-4 rounded-xl transition-all shadow-lg transform hover:scale-105">
                                Entrar no Bot
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const BotAnaliseCompleto = ({ usuario, onLogout }) => {
            const [showSettings, setShowSettings] = useState(false);
            const [images, setImages] = useState([null, null]);
            const [imagePreviews, setImagePreviews] = useState([null, null]);
            const [loading, setLoading] = useState(false);
            const [countdown, setCountdown] = useState(10);
            const [analysis, setAnalysis] = useState(null);
            const [corretora, setCorretora] = useState('olymptrade');

            const analyzeCharts = () => {
                setLoading(true);
                setCountdown(10);
                const timer = setInterval(() => {
                    setCountdown(prev => {
                        if (prev <= 1) {
                            clearInterval(timer);
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                setTimeout(() => {
                    setAnalysis({
                        tipo: "SUPORTE",
                        valor: "1.0842",
                        proximo_alvo: "1.0865",
                        tendencia: "ALTA",
                        preco_atual: "1.0845",
                        probabilidade: "92%",
                        forca_sinal: "FORTE",
                        confirmacao_multipla: "Identificado rompimento de candle anterior com volume crescente na segunda imagem.",
                        rsi_status: "RSI em 45, indicando espaço para valorização.",
                        analise_tecnica: "O gráfico mostra uma base sólida no suporte atual. A tendência de curto prazo é de correção positiva.",
                        recomendacao: "OPERAÇÃO DE COMPRA recomendada para os próximos 2-3 minutos.",
                        padroes_identificados: ["Martelo", "Suporte Nível 1"]
                    });
                    setLoading(false);
                }, 10500);
            };

            const handleFileUpload = (event, index) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const newPreviews = [...imagePreviews];
                        newPreviews[index] = e.target.result;
                        setImagePreviews(newPreviews);
                    };
                    reader.readAsDataURL(file);
                    const newImages = [...images];
                    newImages[index] = file;
                    setImages(newImages);
                }
            };

            const uploadedCount = images.filter(img => img !== null).length;

            return (
                <div className="min-h-screen bg-gradient-to-br from-black via-amber-600 to-black p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-black/80 backdrop-blur-sm rounded-2xl p-4 mb-6 border-2 border-yellow-400/50 flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <User className="w-8 h-8 text-yellow-400" />
                                <span className="text-yellow-400 font-bold">{usuario.nome}</span>
                            </div>
                            <button onClick={onLogout} className="bg-red-600 text-white px-4 py-2 rounded-lg font-bold">Sair</button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                            {[0, 1].map((index) => (
                                <div key={index} className="bg-black/80 rounded-2xl p-6 border-2 border-yellow-400/50 text-center">
                                    {!imagePreviews[index] ? (
                                        <label className="cursor-pointer">
                                            <Upload className="w-12 h-12 text-yellow-400 mx-auto mb-2" />
                                            <p className="text-white">Enviar Foto {index + 1}</p>
                                            <input type="file" className="hidden" onChange={(e) => handleFileUpload(e, index)} />
                                        </label>
                                    ) : (
                                        <img src={imagePreviews[index]} className="w-full rounded-lg" />
                                    )}
                                </div>
                            ))}
                        </div>

                        {uploadedCount === 2 && !loading && !analysis && (
                            <button onClick={analyzeCharts} className="w-full bg-yellow-400 text-black font-bold py-4 rounded-xl text-xl">ANALISAR AGORA</button>
                        )}

                        {loading && (
                            <div className="text-center text-yellow-400 text-3xl font-bold animate-pulse">ANALISANDO: {countdown}s</div>
                        )}

                        {analysis && (
                            <div className="bg-black/90 border-2 border-yellow-400 rounded-2xl p-6 text-white">
                                <h2 className="text-2xl font-bold text-yellow-400 mb-4">RESULTADO DA ANÁLISE</h2>
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="bg-yellow-900/20 p-4 rounded-lg">
                                        <p className="text-yellow-400">Tipo</p>
                                        <p className="text-2xl font-bold">{analysis.tipo}</p>
                                    </div>
                                    <div className="bg-yellow-900/20 p-4 rounded-lg">
                                        <p className="text-yellow-400">Probabilidade</p>
                                        <p className="text-2xl font-bold">{analysis.probabilidade}</p>
                                    </div>
                                </div>
                                <p className="mt-4 text-green-400">{analysis.recomendacao}</p>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            const [usuarioLogado, setUsuarioLogado] = useState(null);
            // Inicializar os ícones após montar o componente
            useEffect(() => { lucide.createIcons(); }, [usuarioLogado]);

            return !usuarioLogado ? 
                <LoginPage onLogin={setUsuarioLogado} /> : 
                <BotAnaliseCompleto usuario={usuarioLogado} onLogout={() => setUsuarioLogado(null)} />;
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
